////////////////////////////////////////////////////////////////////////////////
//                                                                            //
// Copyright (C) 2021-2023 CryptoLab, Inc.                                    //
//                                                                            //
// - This file is part of HEaaN homomorphic encryption library.               //
// - HEaaN cannot be copied and/or distributed without the express permission //
//  of CryptoLab, Inc.                                                        //
//                                                                            //
////////////////////////////////////////////////////////////////////////////////

#include "SignDecompose.hpp"

#include <cmath>
#include <iostream>
#include <vector>

namespace {

using namespace HEaaN;

void computeDegreeSevenOddOfFactorization(const HomEvaluator &eval,
                                          const std::vector<Real> &coeff,
                                          const Ciphertext &ctxt,
                                          Ciphertext &res,
                                          const Real scale = 1.0) {
    Ciphertext tmp1(eval.getContext()), tmp2(eval.getContext());
    eval.square(ctxt, tmp1);                // x^2
    eval.add(tmp1, coeff[1], tmp2);         // x^2 + c'
    eval.square(tmp2, tmp2);                //(x^2 + c')^2
    eval.add(tmp2, coeff[0], tmp2);         //(x^2+c')^2+d'
    eval.add(tmp1, coeff[2], tmp1);         // x^2+b'
    eval.mult(ctxt, scale * coeff[3], res); //((a'x)
    eval.mult(res, tmp1, res);              // ax(x^2+b')
    eval.mult(res, tmp2, res);              // ax(x^2+b')((x^2+c')^2+d')=res
}
}; // namespace

namespace SignCoeffDecomposeTable {

// NUM_DECOMPSE[i-1]+1 ~ NUM_DECOMPOSE[i] : the sequnce of index that
// storeing the sequence of optimal degree seven odd coeffients at COEFF
// accroding https://eprint.iacr.org/2020/834.pdf

static const std::vector<Real> SIGN_MONOMIAL_COEFF_1_0{
    5.73654353000331133300e-01, -5.23740489955249592043e-01,
    -1.51122301409880384401e+00, -2.42763901896422806670e+00};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_1_1{
    2.07052212268834495271e+00, -8.37120992531158145674e-01,
    -2.52592323895929691655e+00, -3.12505867507944846794e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_2_0{
    1.91339114605690868302e-01, -4.43192399561740215449e-01,
    -1.19000292916850952455e+00, -9.67707524057281592182e+00};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_2_1{
    2.05420497386973574646e+00, -8.42851913524232384338e-01,
    -2.53551748572079336776e+00, -3.13256638310339337132e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_3_0{
    7.43363295500591758175e-02, -4.20376620371266873700e-01,
    -1.07857965939468001806e+00, -2.31267476090683709513e+01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_3_1{
    1.89994555059420324975e+00, -8.97300780044557233192e-01,
    -2.62744159007176880290e+00, -3.20733417281936646617e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_3_2{
    2.07062976451315748507e+00, -8.37083204163867324181e-01,
    -2.52586002752222016744e+00, -3.12500938776840990487e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_4_0{
    3.21590826382375058901e-02, -4.12765368535360081977e-01,
    -1.03581293946873223844e+00, -3.87935336622078954556e+01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_4_1{
    1.48940950085889161929e+00, -1.04480951423024919507e+00,
    -2.88366274991984279241e+00, -3.44758221437453753712e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_4_2{
    2.06709645058013366090e+00, -8.38323717920393552563e-01,
    -2.52793547546385642051e+00, -3.12662886579472407091e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_5_0{
    1.48695661478888766258e-02, -4.09795039239397813650e-01,
    -1.01775991296595124009e+00, -5.18407520211394918204e+01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_5_1{
    9.73862139487803574905e-01, -1.23646155778821514826e+00,
    -3.23282131118837769073e+00, -3.87726612327713651350e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_5_2{
    2.00619041007753681572e+00, -8.59746793333076170130e-01,
    -2.56389091594970510338e+00, -3.15508709909780627833e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_6_0{
    7.13778932553279250841e-03, -4.08501452496503494343e-01,
    -1.00957526793610826547e+00, -6.05415407174392384872e+01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_6_1{
    5.61359830249417895388e-01, -1.39631197307909493958e+00,
    -3.53837406009465644863e+00, -4.39633592923499713215e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_6_2{
    1.73738224084364037514e+00, -9.55236006296987475613e-01,
    -2.72680608257373490482e+00, -3.29447349832943344013e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_6_3{
    2.07032221969769194003e+00, -8.37191170397844273138e-01,
    -2.52604063250654489606e+00, -3.12515021546337100827e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_7_0{
    3.49536294054973455821e-03, -4.07900237622539643609e-01,
    -1.00569417398727609432e+00, -6.56189542360540406794e+01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_7_1{
    3.01406641925601017722e-01, -1.50074170488862745891e+00,
    -3.74494784883656691804e+00, -4.85792919961998643671e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_7_2{
    1.25630214699532982848e+00, -1.13048239322448041306e+00,
    -3.03743822317015385420e+00, -3.61968599463341011461e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_7_3{
    2.05477978985256881687e+00, -8.42649935567540049181e-01,
    -2.53517908999668778400e+00, -3.13230066889480139249e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_8_0{
    1.72940201187949673101e-03, -4.07610727352603994149e-01,
    -1.00380649355162496202e+00, -6.83699205222411207459e+01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_8_1{
    1.56108139279298153282e-01, -1.56056545776473851055e+00,
    -3.86569556990728190847e+00, -5.18344437853493721202e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_8_2{
    7.73343218609683368570e-01, -1.31334558659548647228e+00,
    -3.37815950764392947700e+00, -4.10374082523784416400e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_8_3{
    1.92080873382521509458e+00, -8.89907540283510286564e-01,
    -2.61487747946200247165e+00, -3.19679972066947773440e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_8_4{
    2.07063602941905442323e+00, -8.37081004834755106641e-01,
    -2.52585634855988788712e+00, -3.12500651927374363935e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_9_0{
    8.60156862561094925244e-04, -4.07468708915810686883e-01,
    -1.00287587476681046893e+00, -6.98029197788146577097e+01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_9_1{
    7.94466595962439836286e-02, -1.59259075515540284454e+00,
    -3.93103869443673347872e+00, -5.38047401389231123279e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_9_2{
    4.30746620452316653421e-01, -1.44838755397218826699e+00,
    -3.64070860027712067508e+00, -4.61160293303470958804e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_9_3{
    1.54292772052404756997e+00, -1.02534764948163250561e+00,
    -2.84924424119563671987e+00, -3.41219675088943396664e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_9_4{
    2.06831772859821595350e+00, -8.37894910351224268862e-01,
    -2.52721797566830604241e+00, -3.12606871691151141386e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_10_0{
    4.28958324702930843361e-04, -4.07398379150048909481e-01,
    -1.00241387115543588428e+00, -7.05344013235196277706e+01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_10_1{
    4.00830509059074654919e-02, -1.60916532597074254730e+00,
    -3.96504630666436693878e+00, -5.48953153427093987880e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_10_2{
    2.27302846038607019190e-01, -1.53111354505800600395e+00,
    -3.80603426774704205508e+00, -5.01675423262798340535e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_10_3{
    1.03434576084791732435e+00, -1.21354932303762733784e+00,
    -3.19009399973807777889e+00, -3.81671312621689666196e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_10_4{
    2.02155021358128096366e+00, -8.54337043100992416917e-01,
    -2.55479116385235029070e+00, -3.14781195614571261657e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_11_0{
    2.14213836310522421795e-04, -4.07363383538802227427e-01,
    -1.00218369583637976168e+00, -7.09039660810416724622e+01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_11_1{
    2.01247655569896889190e-02, -1.61760377414040764399e+00,
    -3.98240946494595553083e+00, -5.54704488635166505523e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_11_2{
    1.16715757469150812647e-01, -1.57698031662358872329e+00,
    -3.89912718464774959681e+00, -5.28226687955366430264e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_11_3{
    6.05890952118595120907e-01, -1.37872931244601130290e+00,
    -3.50412945994751975815e+00, -4.32952848851282780877e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_11_4{
    1.78716704018868387916e+00, -9.37430364799447315837e-01,
    -2.69609508141898858475e+00, -3.26678958258553902791e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_11_5{
    2.07046573936504959379e+00, -8.37140786358151288959e-01,
    -2.52595634984418510147e+00, -3.12508449326618567649e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_12_0{
    5.35291479303410290700e-05, -4.07337210747902357407e-01,
    -1.00201142594327033145e+00, -7.11828314394443583580e+01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_12_1{
    5.05133227527817727168e-03, -1.62399261656111959695e+00,
    -3.99557726515864166356e+00, -5.59151742050676254298e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_12_2{
    2.97689892988216721865e-02, -1.61352320670728213741e+00,
    -3.97400905907796586907e+00, -5.51906120937313376231e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_12_3{
    1.70812249321583964427e-01, -1.55446020237813891439e+00,
    -3.85329390029072077804e+00, -5.14779946375814151807e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_12_4{
    8.31364835609709469200e-01, -1.29094712884010814266e+00,
    -3.33550650261536762908e+00, -4.03377738764748686508e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_12_5{
    1.95245491514734676576e+00, -8.78710838164572958982e-01,
    -2.59589926012723358587e+00, -3.18108169286980906267e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_12_6{
    2.07064514201686952767e+00, -8.37077805809384553527e-01,
    -2.52585099734395200767e+00, -3.12500234693337669175e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_13_0{
    2.67794943245428760675e-05, -4.07332854770064295641e-01,
    -1.00198274442774929227e+00, -7.12294507733465269372e+01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_13_1{
    2.52955700987368242368e-03, -1.62506279746085101874e+00,
    -3.99778481975496044203e+00, -5.59904673160459815930e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_13_2{
    1.49469989353442758916e-02, -1.61979682533327246571e+00,
    -3.98692735013780798113e+00, -5.56221925057549503990e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_13_3{
    8.71756226999200556205e-02, -1.58934691144619429021e+00,
    -3.92439804962252494234e+00, -5.35971546088249191977e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_13_4{
    4.68317117481178218838e-01, -1.43332905540856899701e+00,
    -3.61097763825115843175e+00, -4.54652442390091375089e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_13_5{
    1.60801566003298115842e+00, -1.00177682096678367059e+00,
    -2.80781122073767996068e+00, -3.37097958675912011169e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_13_6{
    2.06933814360312399336e+00, -8.37536651393443275892e-01,
    -2.52661858661834553413e+00, -3.12560100486741935597e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_14_0{
    1.34080019970253505815e-05, -4.07330677440184415724e-01,
    -1.00196840689857599770e+00, -7.12527756730143039333e+01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_14_1{
    1.26681578357608321285e-03, -1.62559881852071991926e+00,
    -3.99889071546236052188e+00, -5.60282662984826706051e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_14_2{
    7.50266902986330323621e-03, -1.62295269492798679839e+00,
    -3.99343263578281699804e+00, -5.58422308825018808900e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_14_3{
    4.41211543215618743336e-02, -1.60746086262916765088e+00,
    -3.96154318044408279556e+00, -5.47808053644554565090e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_14_4{
    2.48962304756062718767e-01, -1.52220693620304542073e+00,
    -3.78807417454342873777e+00, -4.96886341580242580246e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_14_5{
    1.10436933595894067134e+00, -1.18717502206475762985e+00,
    -3.14124308286752238584e+00, -3.75050674948513311534e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_14_6{
    2.03540444622990312375e+00, -8.49461682496238844764e-01,
    -2.54660207406564074003e+00, -3.14130741978498017920e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_15_0{
    6.72308943728723509279e-06, -4.07329588939997744943e-01,
    -1.00196123894113707406e+00, -7.12644419335009687884e+01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_15_1{
    6.35814793274854475590e-04, -1.62586670818645688698e+00,
    -3.99944346365432776405e+00, -5.60471790684596556702e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_15_2{
    3.76552270233096960824e-03, -1.62453823542462329910e+00,
    -3.99670269423857647971e+00, -5.59535326247731369412e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_15_3{
    2.22271937991530475898e-02, -1.61671374404834102802e+00,
    -3.98057655767599884243e+00, -5.54091351525144913454e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_15_4{
    1.28529031397789435282e-01, -1.57204863599635547732e+00,
    -3.88906955335158232963e+00, -5.25210953798272276374e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_15_5{
    6.57777275238536135069e-01, -1.35834810331215311300e+00,
    -3.46462974702809918538e+00, -4.25546475888958918666e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_15_6{
    1.83741936535408047013e+00, -9.19514516015660840415e-01,
    -2.66534900501587348130e+00, -3.23975845265183598438e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_15_7{
    2.07056825474872992752e+00, -8.37104797541053044014e-01,
    -2.52589614830286570422e+00, -3.12503755163203143401e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_16_0{
    3.38084151446003710385e-06, -4.07329044731150355806e-01,
    -1.00195765516420465723e+00, -7.12702760167623903402e+01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_16_1{
    3.20094347635213682921e-04, -1.62600075541676238932e+00,
    -3.99972006146361203650e+00, -5.60566481434866885816e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_16_2{
    1.89820204004409474264e-03, -1.62533078933185321641e+00,
    -3.99833771253377307145e+00, -5.60093582247199093701e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_16_3{
    1.12320474339545387507e-02, -1.62137128678116960111e+00,
    -3.99017225736687358403e+00, -5.57317213622549037324e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_16_4{
    6.57752106103986092686e-02, -1.59833708640729019120e+00,
    -3.94281443462463969790e+00, -5.41771100439455924683e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_16_5{
    3.62293916034610952759e-01, -1.47599453154941966928e+00,
    -3.69550696266048401990e+00, -4.73742577472324234148e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_16_6{
    1.40545559940615811586e+00, -1.07549140350177538020e+00,
    -2.93830888880924125367e+00, -3.50602112534490913036e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_16_7{
    2.06425310826467224125e+00, -8.39322170109642655002e-01,
    -2.52960646190122822314e+00, -3.12793455343037620853e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_17_0{
    1.70976964171819808245e-06, -4.07328772636970391991e-01,
    -1.00195586332618522196e+00, -7.12731932966632763790e+01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_17_1{
    1.62127068615562461655e-04, -1.62606782674343749029e+00,
    -3.99985846193012021335e+00, -5.60613874193193305876e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_17_2{
    9.61106987296328655832e-04, -1.62572860331617481686e+00,
    -3.99915850183911745924e+00, -5.60374271724979281456e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_17_3{
    5.69418809097390297781e-03, -1.62371986522460198443e+00,
    -3.99501472200126187083e+00, -5.58960215547746455697e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_17_4{
    3.35447617495333787066e-02, -1.61192714360525998616e+00,
    -3.97072544826804589175e+00, -5.50820369515817680155e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_17_5{
    1.91672447954159534094e-01, -1.54581907803752183917e+00,
    -3.83577154691605075327e+00, -5.09834102810696749466e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_17_6{
    9.09935077008708787314e-01, -1.26081511479586587758e+00,
    -3.27853104329843556742e+00, -3.94494571345641126113e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_17_7{
    1.98530009768142945663e+00, -8.67112173737125011393e-01,
    -2.57630236767183644652e+00, -3.16509121796426366996e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_17_8{
    2.07064798970549002889e+00, -8.37076806113662791421e-01,
    -2.52584932508945858816e+00, -3.12500104308078231651e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_18_0{
    8.74246748960545480923e-07, -4.07328636592460848778e-01,
    -1.00195496741978720030e+00, -7.12746519961838561699e+01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_18_1{
    8.31947636396171593255e-05, -1.62610134117505558430e+00,
    -3.99992761912965721919e+00, -5.60637558989767317808e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_18_2{
    4.93783209564780403409e-04, -1.62592701060165996710e+00,
    -3.99956789277043730402e+00, -5.60514383705650851248e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_18_3{
    2.92601193056420980659e-03, -1.62489452612808537936e+00,
    -3.99743767689935268236e+00, -5.59786131883864140822e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_18_4{
    1.72899084161012683121e-02, -1.61880428396680829953e+00,
    -3.98488234854924004282e+00, -5.55533980728148273665e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_18_5{
    1.00555699853950877573e-01, -1.58373937614285879709e+00,
    -3.91293023867785655879e+00, -5.32426879793824529092e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_18_6{
    5.31983802304633654438e-01, -1.40795772928208742889e+00,
    -3.56114142915132306298e+00, -4.44214889306799416950e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_18_7{
    1.70090879004555888913e+00, -9.68317266574322420717e-01,
    -2.74946692037320751025e+00, -3.31535491997676934907e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_18_8{
    2.07013769761649383529e+00, -8.37255949355880753120e-01,
    -2.52614899679444682094e+00, -3.12523472213378739296e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_19_0{
    4.56488558504031415155e-07, -4.07328568570834676302e-01,
    -1.00195451946974111352e+00, -7.12753813608336655378e+01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_19_1{
    4.37544614532024855599e-05, -1.62611808755559942527e+00,
    -3.99996217556516795940e+00, -5.60649394584766867735e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_19_2{
    2.59906649003005170992e-04, -1.62602631033380688031e+00,
    -3.99977279332682227597e+00, -5.60584537523728599321e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_19_3{
    1.54086458193161367715e-03, -1.62548247936867764315e+00,
    -3.99865067823470606983e+00, -5.60200573864018154890e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_19_4{
    9.12108911772430937066e-03, -1.62226631643229818086e+00,
    -3.99201739188310238246e+00, -5.57942050227294127759e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_19_5{
    5.35467825767935825896e-02, -1.60348607755726625848e+00,
    -3.95337919925976745703e+00, -5.45158994305865944010e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_19_6{
    2.98927310160162829835e-01, -1.50175332685218841776e+00,
    -3.74697528647893196351e+00, -4.86301972204191453013e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_19_7{
    1.24933823057816374019e+00, -1.13306558054905305517e+00,
    -3.04213247723527884258e+00, -3.62533006841825151816e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_19_8{
    2.05420497386973574646e+00, -8.42851913524232384338e-01,
    -2.53551748572079336776e+00, -3.13256638310339337132e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_20_0{
    2.47610277153275231644e-07, -4.07328534560188799992e-01,
    -1.00195429549550630124e+00, -7.12757460468845521806e+01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_20_1{
    2.40082314797140723824e-05, -1.62612647185441193630e+00,
    -3.99997947675387581392e+00, -5.60655320447080110938e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_20_2{
    1.42966765018717676623e-04, -1.62607596211911090633e+00,
    -3.99987524927155820360e+00, -5.60619623289561013663e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_20_3{
    8.48234449965032243556e-04, -1.62577652334646440307e+00,
    -3.99925737772287547257e+00, -5.60408104758060257452e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_20_4{
    5.02468469689599232123e-03, -1.62400392315202201432e+00,
    -3.99560058547585617109e+00, -5.59159684791880531348e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_20_5{
    2.96094233926878087750e-02, -1.61359067568133282926e+00,
    -3.97414789034693626152e+00, -5.51952126362568428506e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_20_6{
    1.69867687526549183358e-01, -1.55485203629068063423e+00,
    -3.85408930231913773164e+00, -5.15006953414665989359e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_20_7{
    8.27649145018764398104e-01, -1.29237772266959909271e+00,
    -3.33822309956616957646e+00, -4.03814267039347645417e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_20_8{
    1.95039030341124604302e+00, -8.79440671231710933556e-01,
    -2.59713450176001208362e+00, -3.18209771608558349180e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_20_9{
    2.07064514201686952767e+00, -8.37077805809384553527e-01,
    -2.52585099734395200767e+00, -3.12500234693337669175e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_21_0{
    1.43171339947122808149e-07, -4.07328517554907664257e-01,
    -1.00195418350858595287e+00, -7.12759283908415005496e+01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_21_1{
    1.41416135984068922315e-05, -1.62613066125390063734e+00,
    -3.99998812168615046836e+00, -5.60658281488059120594e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_21_2{
    8.44443553817243399203e-05, -1.62610081059906223793e+00,
    -3.99992652427931742815e+00, -5.60637184011616245887e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_21_3{
    5.01280517440946953980e-04, -1.62592382743568249697e+00,
    -3.99956132452527559702e+00, -5.60512135175935859108e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_21_4{
    2.97098712797442780863e-03, -1.62487543745268542225e+00,
    -3.99739829789019023608e+00, -5.59772688191754557480e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_21_5{
    1.75561199892081447138e-02, -1.61869152785232957453e+00,
    -3.98465005819192957522e+00, -5.55455951039704052102e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_21_6{
    1.02088295991123995397e-01, -1.58309772223710240164e+00,
    -3.91161895495799853121e+00, -5.32024772015702561081e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_21_7{
    5.39144582103090963164e-01, -1.40511544563199354655e+00,
    -3.55557849817738483660e+00, -4.43084958607904758184e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_21_8{
    1.70975367395884876748e+00, -9.65142168808602081983e-01,
    -2.74395897337824776673e+00, -3.31024326699472859575e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_21_9{
    2.07017129859113332114e+00, -8.37244153231293432153e-01,
    -2.52612926371894867669e+00, -3.12521933301184573335e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_22_0{
    9.09519222113343204386e-08, -4.07328509052277546987e-01,
    -1.00195412751517504313e+00, -7.12760195630528521908e+01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_22_1{
    9.20830179976433778588e-06, -1.62613275595703805679e+00,
    -3.99999244416237236923e+00, -5.60659762024305629754e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_22_2{
    5.51830499988012332728e-05, -1.62611323495920698718e+00,
    -3.99995216213798724448e+00, -5.60645964927458161464e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_22_3{
    3.27800018664036104187e-04, -1.62599748370438583360e+00,
    -3.99971331039767868656e+00, -5.60564169868566321135e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_22_4{
    1.94318086984073159538e-03, -1.62531169632793204152e+00,
    -3.99829832074983283997e+00, -5.60080118667742830127e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_22_5{
    1.14983890896806824276e-02, -1.62125837901255528605e+00,
    -3.98993952042329549091e+00, -5.57238504175052108176e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_22_6{
    6.73127687469917312522e-02, -1.59769028628060023486e+00,
    -3.94148819871117074072e+00, -5.41348971863012794226e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_22_7{
    3.70071880768886674230e-01, -1.47284636566585407715e+00,
    -3.68923900189470865586e+00, -4.72263313464582284732e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_22_8{
    1.42275671913181346270e+00, -1.06915300818721905809e+00,
    -2.92698112642045982920e+00, -3.49367203321985805379e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_22_9{
    2.06495660622350674847e+00, -8.39075118653792772571e-01,
    -2.52919295904844983691e+00, -3.12761129679708597319e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_23_0{
    5.17873811639269527410e-08, -4.07328502675309531168e-01,
    -1.00195408552013841401e+00, -7.12760879423132500891e+01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_23_1{
    5.51157086545455921359e-06, -1.62613432560417747796e+00,
    -3.99999568317270764080e+00, -5.60660871456791831544e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_23_2{
    3.32890934966298857454e-05, -1.62612253117408631922e+00,
    -3.99997134506771902170e+00, -5.60652535231708387858e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_23_3{
    1.97948428654691287098e-04, -1.62605261722006926078e+00,
    -3.99982707717251352832e+00, -5.60603126307859814550e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_23_4{
    1.17352123267354916299e-03, -1.62563842494227100970e+00,
    -3.99897243499774788396e+00, -5.60310615603149869275e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_23_5{
    6.94982761683274147774e-03, -1.62318719326418633348e+00,
    -3.99391619783721510399e+00, -5.58586603548564388291e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_23_6{
    4.08801553233349260974e-02, -1.60882879612818076456e+00,
    -3.96435454099895670179e+00, -5.48726627317695830362e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_23_7{
    2.31472565799205947434e-01, -1.52939699897035573953e+00,
    -3.80256988659563365742e+00, -5.00743666022430123685e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_23_8{
    1.04822464235357517955e+00, -1.20830908533833751386e+00,
    -3.18035962249436300667e+00, -3.80326868822211874662e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_23_9{
    2.02482551614008240787e+00, -8.53184098700360465706e-01,
    -2.55285356979904039472e+00, -3.14626931728208261163e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_24_0{
    4.52599595105617087492e-08, -4.07328501612481909543e-01,
    -1.00195407852096743859e+00, -7.12760993388651400977e+01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_24_1{
    4.89327949560194839676e-06, -1.62613458813331530586e+00,
    -3.99999622490895967885e+00, -5.60661057013859326939e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_24_2{
    2.96184027045218875925e-05, -1.62612408975915674788e+00,
    -3.99997456124369123522e+00, -5.60653636813139981525e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_24_3{
    1.76184881773938272539e-04, -1.62606185787543777250e+00,
    -3.99984614519519594606e+00, -5.60609656206977463946e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_24_4{
    1.04524011095640338137e-03, -1.62569288510220890428e+00,
    -3.99908480328552311114e+00, -5.60349056581029831519e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_24_5{
    6.19046373592435801614e-03, -1.62350932203584065480e+00,
    -3.99458050517716926450e+00, -5.58812474048192498990e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_24_6{
    3.64422544349421950460e-02, -1.61070291163202169234e+00,
    -3.96820761514402391379e+00, -5.49990886067173179857e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_24_7{
    2.07468366874223952851e-01, -1.53929137373862609137e+00,
    -3.82255849479345532028e+00, -5.06173072466834224034e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_24_8{
    9.66745934049969686877e-01, -1.23916549245583670309e+00,
    -3.23788140373334815853e+00, -3.88460767853408356306e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_24_9{
    2.00388295058317975397e+00, -8.60559902093676204684e-01,
    -2.56525983684135994418e+00, -3.15618587772277742977e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_25_0{
    4.19962488825793609694e-08, -4.07328501081068139553e-01,
    -1.00195407502138214332e+00, -7.12761050371419947840e+01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_25_1{
    4.58413379945287979147e-06, -1.62613471939789785006e+00,
    -3.99999649577712529889e+00, -5.60661149792455160730e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_25_2{
    2.77960735506376372349e-05, -1.62612486352527042998e+00,
    -3.99997615792818061361e+00, -5.60654183699706177573e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_25_3{
    1.65355160413414248385e-04, -1.62606645611282736066e+00,
    -3.99985563363801257806e+00, -5.60612905611012681501e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_25_4{
    9.80266064289188828612e-04, -1.62572046940713239810e+00,
    -3.99914171882821554634e+00, -5.60368529393982286437e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_25_5{
    5.80743391507095532591e-03, -1.62367181977932786824e+00,
    -3.99491563297096495144e+00, -5.58926493447964050053e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_25_6{
    3.42093867594250710118e-02, -1.61164628619906332573e+00,
    -3.97014775751294163080e+00, -5.50629819011959637924e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_25_7{
    1.95231634098168093952e-01, -1.54434706789451528412e+00,
    -3.83279019108885636177e+00, -5.09002950086587173248e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_25_8{
    9.22970830744841360082e-01, -1.25583738145430852797e+00,
    -3.26916354199654300160e+00, -3.93082314252399255102e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_25_9{
    1.99005028553298674426e+00, -8.65436590297191579988e-01,
    -2.57347658513004545397e+00, -3.16280520672713552673e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_25_10{
    2.07064798970549002889e+00, -8.37076806113662791421e-01,
    -2.52584932508945858816e+00, -3.12500104308078231651e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_26_0{
    4.03643936182632550631e-08, -4.07328500815361264764e-01,
    -1.00195407327158954380e+00, -7.12761078862806495476e+01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_26_1{
    4.43118803122324202292e-06, -1.62613478433932625811e+00,
    -3.99999662978559594626e+00, -5.60661195693459982762e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_26_2{
    2.68849088761989871254e-05, -1.62612525040844567732e+00,
    -3.99997695627076931607e+00, -5.60654457143528592766e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_26_3{
    1.60044428312899243491e-04, -1.62606871102177631020e+00,
    -3.99986028663623348423e+00, -5.60614499087317138969e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_26_4{
    9.49444926331851519756e-04, -1.62573355440791402546e+00,
    -3.99916871763453684950e+00, -5.60377767134307286124e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_26_5{
    5.62424163380164683879e-03, -1.62374954095316569592e+00,
    -3.99507592582076539567e+00, -5.58981046644172778184e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_26_6{
    3.31459689338993329730e-02, -1.61209567811810046219e+00,
    -3.97107212160542273508e+00, -5.50934786282562473484e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_26_7{
    1.89473410765440350897e-01, -1.54672889762029558292e+00,
    -3.83761478211697053779e+00, -5.10349461373025438961e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_26_8{
    9.01942595544326078761e-01, -1.26387005386916939724e+00,
    -3.28428635371693412616e+00, -3.95368855963089608727e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_26_9{
    1.98220744415178970448e+00, -8.68203328847547670376e-01,
    -2.57814325479817121387e+00, -3.16658312058985424763e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_26_10{
    2.07064798970549002889e+00, -8.37076806113662791421e-01,
    -2.52584932508945858816e+00, -3.12500104308078231651e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_27_0{
    3.95484659985239690345e-08, -4.07328500682507829921e-01,
    -1.00195407239669325606e+00, -7.12761093108500337846e+01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_27_1{
    4.35308806376136400273e-06, -1.62613481750090757964e+00,
    -3.99999669821545579046e+00, -5.60661219132274863187e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_27_2{
    2.64293265235233794121e-05, -1.62612544385006229252e+00,
    -3.99997735544214967061e+00, -5.60654593865572363317e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_27_3{
    1.57336995411630529104e-04, -1.62606986058423334084e+00,
    -3.99986265875597203914e+00, -5.60615311452485685402e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_27_4{
    9.32784820732066033272e-04, -1.62574062741831047174e+00,
    -3.99918331169317484858e+00, -5.60382760678049459866e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_27_5{
    5.52431745145364972680e-03, -1.62379193564669430696e+00,
    -3.99516336219513016066e+00, -5.59010808984635074813e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_27_6{
    3.25610486673755183959e-02, -1.61234288929468978093e+00,
    -3.97158065572024262802e+00, -5.51102714964571341478e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_27_7{
    1.86226217700412197242e-01, -1.54807285294135567023e+00,
    -3.84033827405884370123e+00, -5.11113034200322732231e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_27_8{
    8.90281975773307942028e-01, -1.26833115617502828569e+00,
    -3.29269936420948198450e+00, -3.96656010676922734997e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_27_9{
    1.97769531378166826381e+00, -8.69795661979716116967e-01,
    -2.58083068734701333558e+00, -3.16876485966489488390e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_27_10{
    2.07064798970549002889e+00, -8.37076806113662791421e-01,
    -2.52584932508945858816e+00, -3.12500104308078231651e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_28_0{
    3.91405021917590177424e-08, -4.07328500616081113137e-01,
    -1.00195407195924511520e+00, -7.12761100231347401169e+01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_28_1{
    4.31403807985135841085e-06, -1.62613483408169845788e+00,
    -3.99999673243038634441e+00, -5.60661230851683294026e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_28_2{
    2.61950270232110627030e-05, -1.62612554333432983567e+00,
    -3.99997756073031046443e+00, -5.60654664179800876977e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_28_3{
    1.55879146688564018371e-04, -1.62607047957969120362e+00,
    -3.99986393605205461348e+00, -5.60615748881198716909e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_28_4{
    9.24454759767355148811e-04, -1.62574416393340808244e+00,
    -3.99919060875125054729e+00, -5.60385257494925549248e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_28_5{
    5.47435506466034905283e-03, -1.62381313334450238963e+00,
    -3.99520708141753497484e+00, -5.59025691756985576301e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_28_6{
    3.22685777788531002161e-02, -1.61246650702258626772e+00,
    -3.97183495840288232938e+00, -5.51186731711715824149e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_28_7{
    1.84549784417345845290e-01, -1.54876692151354958188e+00,
    -3.84174512561866668860e+00, -5.11508450510417579358e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_28_8{
    8.83704661598992745737e-01, -1.27084965329417835244e+00,
    -3.29745339157620535860e+00, -3.97388196873411970498e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_28_9{
    1.97539780018586137678e+00, -8.70606618206579392517e-01,
    -2.58219982472231818199e+00, -3.16987809383036831504e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_28_10{
    2.07064798970549002889e+00, -8.37076806113662791421e-01,
    -2.52584932508945858816e+00, -3.12500104308078231651e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_29_0{
    3.89365202891527150258e-08, -4.07328500582867754904e-01,
    -1.00195407174052104552e+00, -7.12761103792770968364e+01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_29_1{
    4.29451308785158897347e-06, -1.62613484237209395137e+00,
    -3.99999674953785177936e+00, -5.60661236711387757102e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_29_2{
    2.60778772714432331195e-05, -1.62612559307646556458e+00,
    -3.99997766337439654808e+00, -5.60654699336924049082e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_29_3{
    1.55254354327728250833e-04, -1.62607074486352072174e+00,
    -3.99986448346484116043e+00, -5.60615936350928856294e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_29_4{
    9.21122733857198472649e-04, -1.62574557854113235396e+00,
    -3.99919352757984866028e+00, -5.60386256229966453193e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_29_5{
    5.45437005456399727096e-03, -1.62382161248895385963e+00,
    -3.99522456929973779275e+00, -5.59031645164928401987e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_29_6{
    3.21356340972074445419e-02, -1.61252269957421282807e+00,
    -3.97195055838266354757e+00, -5.51224932699113520624e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_29_7{
    1.83816246080353655077e-01, -1.54907066516313718847e+00,
    -3.84236087545522453244e+00, -5.11681727446088418159e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_29_8{
    8.80777222271660537444e-01, -1.27197109174491613461e+00,
    -3.29957131283680952554e+00, -3.97715519115711570490e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_29_9{
    1.97400604076287347648e+00, -8.71097922652531165284e-01,
    -2.58302944510872968522e+00, -3.17055321969398574716e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_29_10{
    2.07064798970549002889e+00, -8.37076806113662791421e-01,
    -2.52584932508945858816e+00, -3.12500104308078231651e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_30_0{
    3.88345293380436068998e-08, -4.07328500566261075828e-01,
    -1.00195407163115901087e+00, -7.12761105573482760846e+01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_30_1{
    4.28475059184051259492e-06, -1.62613484651729171171e+00,
    -3.99999675809158453632e+00, -5.60661239641240050555e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_30_2{
    2.60258107147570912397e-05, -1.62612561518408186295e+00,
    -3.99997770899399157996e+00, -5.60654714962314033369e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_30_3{
    1.54941958135846608009e-04, -1.62607087750544939989e+00,
    -3.99986475717127487301e+00, -5.60616030085857307979e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_30_4{
    9.18623713853054541796e-04, -1.62574663949761367285e+00,
    -3.99919571670331021172e+00, -5.60387005284394273331e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_30_5{
    5.44104669692220574086e-03, -1.62382726527294688982e+00,
    -3.99523622794922019794e+00, -5.59035614198675192737e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_30_6{
    3.20558671778984126133e-02, -1.61255641590769632950e+00,
    -3.97201992072592635267e+00, -5.51247856759689439305e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_30_7{
    1.83397054360503649620e-01, -1.54924425718560703239e+00,
    -3.84271280145192416247e+00, -5.11780820116156391581e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_30_8{
    8.79312538552377816842e-01, -1.27253229670727851026e+00,
    -3.30063143233693001189e+00, -3.97879622520214507929e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_30_9{
    1.97353991344210992884e+00, -8.71262479085712133892e-01,
    -2.58330734183486122137e+00, -3.17077946163469264256e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_30_10{
    2.07064798970549002889e+00, -8.37076806113662791421e-01,
    -2.52584932508945858816e+00, -3.12500104308078231651e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_31_0{
    3.87835338625375636448e-08, -4.07328500557957736300e-01,
    -1.00195407157647799359e+00, -7.12761106463838659307e+01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_31_1{
    4.28149642650182911175e-06, -1.62613484789902430050e+00,
    -3.99999676094282879449e+00, -5.60661240617857490878e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_31_2{
    2.59997774363344316283e-05, -1.62612562623789010879e+00,
    -3.99997773180378937673e+00, -5.60654722775009465773e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_31_3{
    1.54733694003679107456e-04, -1.62607096593340423306e+00,
    -3.99986493964224565860e+00, -5.60616092575831192447e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_31_4{
    9.17790707076146006957e-04, -1.62574699314990610390e+00,
    -3.99919644641151415157e+00, -5.60387254969803631861e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_31_5{
    5.43771585531471681509e-03, -1.62382867847158709267e+00,
    -3.99523914261925923996e+00, -5.59036606469011175196e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_31_6{
    3.20558671778984126133e-02, -1.61255641590769632950e+00,
    -3.97201992072592635267e+00, -5.51247856759689439305e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_31_7{
    1.83397054360503649620e-01, -1.54924425718560703239e+00,
    -3.84271280145192416247e+00, -5.11780820116156391581e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_31_8{
    8.79312538552377816842e-01, -1.27253229670727851026e+00,
    -3.30063143233693001189e+00, -3.97879622520214507929e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_31_9{
    1.97353991344210992884e+00, -8.71262479085712133892e-01,
    -2.58330734183486122137e+00, -3.17077946163469264256e-01};
static const std::vector<Real> SIGN_MONOMIAL_COEFF_31_10{
    2.07064798970549002889e+00, -8.37076806113662791421e-01,
    -2.52584932508945858816e+00, -3.12500104308078231651e-01};
static const std::vector<std::vector<Real>> SIGN_MONOMIAL_COEFF_1{
    SIGN_MONOMIAL_COEFF_1_0, SIGN_MONOMIAL_COEFF_1_1};
static const std::vector<std::vector<Real>> SIGN_MONOMIAL_COEFF_2{
    SIGN_MONOMIAL_COEFF_2_0, SIGN_MONOMIAL_COEFF_2_1};
static const std::vector<std::vector<Real>> SIGN_MONOMIAL_COEFF_3{
    SIGN_MONOMIAL_COEFF_3_0, SIGN_MONOMIAL_COEFF_3_1, SIGN_MONOMIAL_COEFF_3_2};
static const std::vector<std::vector<Real>> SIGN_MONOMIAL_COEFF_4{
    SIGN_MONOMIAL_COEFF_4_0, SIGN_MONOMIAL_COEFF_4_1, SIGN_MONOMIAL_COEFF_4_2};
static const std::vector<std::vector<Real>> SIGN_MONOMIAL_COEFF_5{
    SIGN_MONOMIAL_COEFF_5_0, SIGN_MONOMIAL_COEFF_5_1, SIGN_MONOMIAL_COEFF_5_2};
static const std::vector<std::vector<Real>> SIGN_MONOMIAL_COEFF_6{
    SIGN_MONOMIAL_COEFF_6_0, SIGN_MONOMIAL_COEFF_6_1, SIGN_MONOMIAL_COEFF_6_2,
    SIGN_MONOMIAL_COEFF_6_3};
static const std::vector<std::vector<Real>> SIGN_MONOMIAL_COEFF_7{
    SIGN_MONOMIAL_COEFF_7_0, SIGN_MONOMIAL_COEFF_7_1, SIGN_MONOMIAL_COEFF_7_2,
    SIGN_MONOMIAL_COEFF_7_3};
static const std::vector<std::vector<Real>> SIGN_MONOMIAL_COEFF_8{
    SIGN_MONOMIAL_COEFF_8_0, SIGN_MONOMIAL_COEFF_8_1, SIGN_MONOMIAL_COEFF_8_2,
    SIGN_MONOMIAL_COEFF_8_3, SIGN_MONOMIAL_COEFF_8_4};
static const std::vector<std::vector<Real>> SIGN_MONOMIAL_COEFF_9{
    SIGN_MONOMIAL_COEFF_9_0, SIGN_MONOMIAL_COEFF_9_1, SIGN_MONOMIAL_COEFF_9_2,
    SIGN_MONOMIAL_COEFF_9_3, SIGN_MONOMIAL_COEFF_9_4};
static const std::vector<std::vector<Real>> SIGN_MONOMIAL_COEFF_10{
    SIGN_MONOMIAL_COEFF_10_0, SIGN_MONOMIAL_COEFF_10_1,
    SIGN_MONOMIAL_COEFF_10_2, SIGN_MONOMIAL_COEFF_10_3,
    SIGN_MONOMIAL_COEFF_10_4};
static const std::vector<std::vector<Real>> SIGN_MONOMIAL_COEFF_11{
    SIGN_MONOMIAL_COEFF_11_0, SIGN_MONOMIAL_COEFF_11_1,
    SIGN_MONOMIAL_COEFF_11_2, SIGN_MONOMIAL_COEFF_11_3,
    SIGN_MONOMIAL_COEFF_11_4, SIGN_MONOMIAL_COEFF_11_5};
static const std::vector<std::vector<Real>> SIGN_MONOMIAL_COEFF_12{
    SIGN_MONOMIAL_COEFF_12_0, SIGN_MONOMIAL_COEFF_12_1,
    SIGN_MONOMIAL_COEFF_12_2, SIGN_MONOMIAL_COEFF_12_3,
    SIGN_MONOMIAL_COEFF_12_4, SIGN_MONOMIAL_COEFF_12_5,
    SIGN_MONOMIAL_COEFF_12_6};
static const std::vector<std::vector<Real>> SIGN_MONOMIAL_COEFF_13{
    SIGN_MONOMIAL_COEFF_13_0, SIGN_MONOMIAL_COEFF_13_1,
    SIGN_MONOMIAL_COEFF_13_2, SIGN_MONOMIAL_COEFF_13_3,
    SIGN_MONOMIAL_COEFF_13_4, SIGN_MONOMIAL_COEFF_13_5,
    SIGN_MONOMIAL_COEFF_13_6};
static const std::vector<std::vector<Real>> SIGN_MONOMIAL_COEFF_14{
    SIGN_MONOMIAL_COEFF_14_0, SIGN_MONOMIAL_COEFF_14_1,
    SIGN_MONOMIAL_COEFF_14_2, SIGN_MONOMIAL_COEFF_14_3,
    SIGN_MONOMIAL_COEFF_14_4, SIGN_MONOMIAL_COEFF_14_5,
    SIGN_MONOMIAL_COEFF_14_6};
static const std::vector<std::vector<Real>> SIGN_MONOMIAL_COEFF_15{
    SIGN_MONOMIAL_COEFF_15_0, SIGN_MONOMIAL_COEFF_15_1,
    SIGN_MONOMIAL_COEFF_15_2, SIGN_MONOMIAL_COEFF_15_3,
    SIGN_MONOMIAL_COEFF_15_4, SIGN_MONOMIAL_COEFF_15_5,
    SIGN_MONOMIAL_COEFF_15_6, SIGN_MONOMIAL_COEFF_15_7};
static const std::vector<std::vector<Real>> SIGN_MONOMIAL_COEFF_16{
    SIGN_MONOMIAL_COEFF_16_0, SIGN_MONOMIAL_COEFF_16_1,
    SIGN_MONOMIAL_COEFF_16_2, SIGN_MONOMIAL_COEFF_16_3,
    SIGN_MONOMIAL_COEFF_16_4, SIGN_MONOMIAL_COEFF_16_5,
    SIGN_MONOMIAL_COEFF_16_6, SIGN_MONOMIAL_COEFF_16_7};
static const std::vector<std::vector<Real>> SIGN_MONOMIAL_COEFF_17{
    SIGN_MONOMIAL_COEFF_17_0, SIGN_MONOMIAL_COEFF_17_1,
    SIGN_MONOMIAL_COEFF_17_2, SIGN_MONOMIAL_COEFF_17_3,
    SIGN_MONOMIAL_COEFF_17_4, SIGN_MONOMIAL_COEFF_17_5,
    SIGN_MONOMIAL_COEFF_17_6, SIGN_MONOMIAL_COEFF_17_7,
    SIGN_MONOMIAL_COEFF_17_8};
static const std::vector<std::vector<Real>> SIGN_MONOMIAL_COEFF_18{
    SIGN_MONOMIAL_COEFF_18_0, SIGN_MONOMIAL_COEFF_18_1,
    SIGN_MONOMIAL_COEFF_18_2, SIGN_MONOMIAL_COEFF_18_3,
    SIGN_MONOMIAL_COEFF_18_4, SIGN_MONOMIAL_COEFF_18_5,
    SIGN_MONOMIAL_COEFF_18_6, SIGN_MONOMIAL_COEFF_18_7,
    SIGN_MONOMIAL_COEFF_18_8};
static const std::vector<std::vector<Real>> SIGN_MONOMIAL_COEFF_19{
    SIGN_MONOMIAL_COEFF_19_0, SIGN_MONOMIAL_COEFF_19_1,
    SIGN_MONOMIAL_COEFF_19_2, SIGN_MONOMIAL_COEFF_19_3,
    SIGN_MONOMIAL_COEFF_19_4, SIGN_MONOMIAL_COEFF_19_5,
    SIGN_MONOMIAL_COEFF_19_6, SIGN_MONOMIAL_COEFF_19_7,
    SIGN_MONOMIAL_COEFF_19_8};
static const std::vector<std::vector<Real>> SIGN_MONOMIAL_COEFF_20{
    SIGN_MONOMIAL_COEFF_20_0, SIGN_MONOMIAL_COEFF_20_1,
    SIGN_MONOMIAL_COEFF_20_2, SIGN_MONOMIAL_COEFF_20_3,
    SIGN_MONOMIAL_COEFF_20_4, SIGN_MONOMIAL_COEFF_20_5,
    SIGN_MONOMIAL_COEFF_20_6, SIGN_MONOMIAL_COEFF_20_7,
    SIGN_MONOMIAL_COEFF_20_8, SIGN_MONOMIAL_COEFF_20_9};
static const std::vector<std::vector<Real>> SIGN_MONOMIAL_COEFF_21{
    SIGN_MONOMIAL_COEFF_21_0, SIGN_MONOMIAL_COEFF_21_1,
    SIGN_MONOMIAL_COEFF_21_2, SIGN_MONOMIAL_COEFF_21_3,
    SIGN_MONOMIAL_COEFF_21_4, SIGN_MONOMIAL_COEFF_21_5,
    SIGN_MONOMIAL_COEFF_21_6, SIGN_MONOMIAL_COEFF_21_7,
    SIGN_MONOMIAL_COEFF_21_8, SIGN_MONOMIAL_COEFF_21_9};
static const std::vector<std::vector<Real>> SIGN_MONOMIAL_COEFF_22{
    SIGN_MONOMIAL_COEFF_22_0, SIGN_MONOMIAL_COEFF_22_1,
    SIGN_MONOMIAL_COEFF_22_2, SIGN_MONOMIAL_COEFF_22_3,
    SIGN_MONOMIAL_COEFF_22_4, SIGN_MONOMIAL_COEFF_22_5,
    SIGN_MONOMIAL_COEFF_22_6, SIGN_MONOMIAL_COEFF_22_7,
    SIGN_MONOMIAL_COEFF_22_8, SIGN_MONOMIAL_COEFF_22_9};
static const std::vector<std::vector<Real>> SIGN_MONOMIAL_COEFF_23{
    SIGN_MONOMIAL_COEFF_23_0, SIGN_MONOMIAL_COEFF_23_1,
    SIGN_MONOMIAL_COEFF_23_2, SIGN_MONOMIAL_COEFF_23_3,
    SIGN_MONOMIAL_COEFF_23_4, SIGN_MONOMIAL_COEFF_23_5,
    SIGN_MONOMIAL_COEFF_23_6, SIGN_MONOMIAL_COEFF_23_7,
    SIGN_MONOMIAL_COEFF_23_8, SIGN_MONOMIAL_COEFF_23_9};
static const std::vector<std::vector<Real>> SIGN_MONOMIAL_COEFF_24{
    SIGN_MONOMIAL_COEFF_24_0, SIGN_MONOMIAL_COEFF_24_1,
    SIGN_MONOMIAL_COEFF_24_2, SIGN_MONOMIAL_COEFF_24_3,
    SIGN_MONOMIAL_COEFF_24_4, SIGN_MONOMIAL_COEFF_24_5,
    SIGN_MONOMIAL_COEFF_24_6, SIGN_MONOMIAL_COEFF_24_7,
    SIGN_MONOMIAL_COEFF_24_8, SIGN_MONOMIAL_COEFF_24_9};
static const std::vector<std::vector<Real>> SIGN_MONOMIAL_COEFF_25{
    SIGN_MONOMIAL_COEFF_25_0, SIGN_MONOMIAL_COEFF_25_1,
    SIGN_MONOMIAL_COEFF_25_2, SIGN_MONOMIAL_COEFF_25_3,
    SIGN_MONOMIAL_COEFF_25_4, SIGN_MONOMIAL_COEFF_25_5,
    SIGN_MONOMIAL_COEFF_25_6, SIGN_MONOMIAL_COEFF_25_7,
    SIGN_MONOMIAL_COEFF_25_8, SIGN_MONOMIAL_COEFF_25_9,
    SIGN_MONOMIAL_COEFF_25_10};
static const std::vector<std::vector<Real>> SIGN_MONOMIAL_COEFF_26{
    SIGN_MONOMIAL_COEFF_26_0, SIGN_MONOMIAL_COEFF_26_1,
    SIGN_MONOMIAL_COEFF_26_2, SIGN_MONOMIAL_COEFF_26_3,
    SIGN_MONOMIAL_COEFF_26_4, SIGN_MONOMIAL_COEFF_26_5,
    SIGN_MONOMIAL_COEFF_26_6, SIGN_MONOMIAL_COEFF_26_7,
    SIGN_MONOMIAL_COEFF_26_8, SIGN_MONOMIAL_COEFF_26_9,
    SIGN_MONOMIAL_COEFF_26_10};
static const std::vector<std::vector<Real>> SIGN_MONOMIAL_COEFF_27{
    SIGN_MONOMIAL_COEFF_27_0, SIGN_MONOMIAL_COEFF_27_1,
    SIGN_MONOMIAL_COEFF_27_2, SIGN_MONOMIAL_COEFF_27_3,
    SIGN_MONOMIAL_COEFF_27_4, SIGN_MONOMIAL_COEFF_27_5,
    SIGN_MONOMIAL_COEFF_27_6, SIGN_MONOMIAL_COEFF_27_7,
    SIGN_MONOMIAL_COEFF_27_8, SIGN_MONOMIAL_COEFF_27_9,
    SIGN_MONOMIAL_COEFF_27_10};
static const std::vector<std::vector<Real>> SIGN_MONOMIAL_COEFF_28{
    SIGN_MONOMIAL_COEFF_28_0, SIGN_MONOMIAL_COEFF_28_1,
    SIGN_MONOMIAL_COEFF_28_2, SIGN_MONOMIAL_COEFF_28_3,
    SIGN_MONOMIAL_COEFF_28_4, SIGN_MONOMIAL_COEFF_28_5,
    SIGN_MONOMIAL_COEFF_28_6, SIGN_MONOMIAL_COEFF_28_7,
    SIGN_MONOMIAL_COEFF_28_8, SIGN_MONOMIAL_COEFF_28_9,
    SIGN_MONOMIAL_COEFF_28_10};
static const std::vector<std::vector<Real>> SIGN_MONOMIAL_COEFF_29{
    SIGN_MONOMIAL_COEFF_29_0, SIGN_MONOMIAL_COEFF_29_1,
    SIGN_MONOMIAL_COEFF_29_2, SIGN_MONOMIAL_COEFF_29_3,
    SIGN_MONOMIAL_COEFF_29_4, SIGN_MONOMIAL_COEFF_29_5,
    SIGN_MONOMIAL_COEFF_29_6, SIGN_MONOMIAL_COEFF_29_7,
    SIGN_MONOMIAL_COEFF_29_8, SIGN_MONOMIAL_COEFF_29_9,
    SIGN_MONOMIAL_COEFF_29_10};
static const std::vector<std::vector<Real>> SIGN_MONOMIAL_COEFF_30{
    SIGN_MONOMIAL_COEFF_30_0, SIGN_MONOMIAL_COEFF_30_1,
    SIGN_MONOMIAL_COEFF_30_2, SIGN_MONOMIAL_COEFF_30_3,
    SIGN_MONOMIAL_COEFF_30_4, SIGN_MONOMIAL_COEFF_30_5,
    SIGN_MONOMIAL_COEFF_30_6, SIGN_MONOMIAL_COEFF_30_7,
    SIGN_MONOMIAL_COEFF_30_8, SIGN_MONOMIAL_COEFF_30_9,
    SIGN_MONOMIAL_COEFF_30_10};
static const std::vector<std::vector<Real>> SIGN_MONOMIAL_COEFF_31{
    SIGN_MONOMIAL_COEFF_31_0, SIGN_MONOMIAL_COEFF_31_1,
    SIGN_MONOMIAL_COEFF_31_2, SIGN_MONOMIAL_COEFF_31_3,
    SIGN_MONOMIAL_COEFF_31_4, SIGN_MONOMIAL_COEFF_31_5,
    SIGN_MONOMIAL_COEFF_31_6, SIGN_MONOMIAL_COEFF_31_7,
    SIGN_MONOMIAL_COEFF_31_8, SIGN_MONOMIAL_COEFF_31_9,
    SIGN_MONOMIAL_COEFF_31_10};

static const std::vector<std::vector<std::vector<Real>>> SIGN_MONOMIAL_COEFF{
    SIGN_MONOMIAL_COEFF_1,  SIGN_MONOMIAL_COEFF_2,  SIGN_MONOMIAL_COEFF_3,
    SIGN_MONOMIAL_COEFF_4,  SIGN_MONOMIAL_COEFF_5,  SIGN_MONOMIAL_COEFF_6,
    SIGN_MONOMIAL_COEFF_7,  SIGN_MONOMIAL_COEFF_8,  SIGN_MONOMIAL_COEFF_9,
    SIGN_MONOMIAL_COEFF_10, SIGN_MONOMIAL_COEFF_11, SIGN_MONOMIAL_COEFF_12,
    SIGN_MONOMIAL_COEFF_13, SIGN_MONOMIAL_COEFF_14, SIGN_MONOMIAL_COEFF_15,
    SIGN_MONOMIAL_COEFF_16, SIGN_MONOMIAL_COEFF_17, SIGN_MONOMIAL_COEFF_18,
    SIGN_MONOMIAL_COEFF_19, SIGN_MONOMIAL_COEFF_20, SIGN_MONOMIAL_COEFF_21,
    SIGN_MONOMIAL_COEFF_22, SIGN_MONOMIAL_COEFF_23, SIGN_MONOMIAL_COEFF_24,
    SIGN_MONOMIAL_COEFF_25, SIGN_MONOMIAL_COEFF_26, SIGN_MONOMIAL_COEFF_27,
    SIGN_MONOMIAL_COEFF_28, SIGN_MONOMIAL_COEFF_29, SIGN_MONOMIAL_COEFF_30,
    SIGN_MONOMIAL_COEFF_31};

static const std::vector<int> SIGN_MONOMIAL_SHIFT_PREC_1 = {-7, -7, -29, -38};
static const std::vector<int> SIGN_MONOMIAL_SHIFT_PREC_2 = {-3, -3, -15, -39};
static const std::vector<int> SIGN_MONOMIAL_SHIFT_PREC_3 = {-1, -8, -34, -38};
static const std::vector<int> SIGN_MONOMIAL_SHIFT_PREC_4 = {0, -4, -19, -39};
static const std::vector<int> SIGN_MONOMIAL_SHIFT_PREC_5 = {0, -2, -11, -39};
static const std::vector<int> SIGN_MONOMIAL_SHIFT_PREC_6 = {-1, -6, -26, -38};
static const std::vector<int> SIGN_MONOMIAL_SHIFT_PREC_7 = {0, -3, -15, -38};
static const std::vector<int> SIGN_MONOMIAL_SHIFT_PREC_8 = {-1, -8, -35, -39};
static const std::vector<int> SIGN_MONOMIAL_SHIFT_PREC_9 = {-1, -5, -20, -38};
static const std::vector<int> SIGN_MONOMIAL_SHIFT_PREC_10 = {0, -2, -12, -38};
static const std::vector<int> SIGN_MONOMIAL_SHIFT_PREC_11 = {-1, -6, -28, -38};
static const std::vector<int> SIGN_MONOMIAL_SHIFT_PREC_12 = {-2, -9, -37, -38};
static const std::vector<int> SIGN_MONOMIAL_SHIFT_PREC_13 = {-1, -5, -22, -38};
static const std::vector<int> SIGN_MONOMIAL_SHIFT_PREC_14 = {0, -3, -13, -38};
static const std::vector<int> SIGN_MONOMIAL_SHIFT_PREC_15 = {-1, -7, -30, -38};
static const std::vector<int> SIGN_MONOMIAL_SHIFT_PREC_16 = {0, -4, -17, -39};
static const std::vector<int> SIGN_MONOMIAL_SHIFT_PREC_17 = {-2, -10, -38, -38};
static const std::vector<int> SIGN_MONOMIAL_SHIFT_PREC_18 = {-1, -5, -23, -38};
static const std::vector<int> SIGN_MONOMIAL_SHIFT_PREC_19 = {0, -3, -13, -38};
static const std::vector<int> SIGN_MONOMIAL_SHIFT_PREC_20 = {-2, -8, -30, -38};
static const std::vector<int> SIGN_MONOMIAL_SHIFT_PREC_21 = {-1, -5, -18, -38};
static const std::vector<int> SIGN_MONOMIAL_SHIFT_PREC_22 = {0, -3, -12, -38};
static const std::vector<int> SIGN_MONOMIAL_SHIFT_PREC_23 = {0, -2, -7, -26};
static const std::vector<int> SIGN_MONOMIAL_SHIFT_PREC_24 = {0, -1, -6, -22};
static const std::vector<int> SIGN_MONOMIAL_SHIFT_PREC_25 = {-1, -5, -21, -38};
static const std::vector<int> SIGN_MONOMIAL_SHIFT_PREC_26 = {-1, -2, -20, -38};
static const std::vector<int> SIGN_MONOMIAL_SHIFT_PREC_27 = {-1, -1, -19, -38};
static const std::vector<int> SIGN_MONOMIAL_SHIFT_PREC_28 = {-1, -5, -19, -38};
static const std::vector<int> SIGN_MONOMIAL_SHIFT_PREC_29 = {-1, -5, -19, -39};
static const std::vector<int> SIGN_MONOMIAL_SHIFT_PREC_30 = {-1, -5, -19, -38};

static const std::vector<std::vector<int>> SIGN_MONOMIAL_SHIFT_PREC = {
    SIGN_MONOMIAL_SHIFT_PREC_1,  SIGN_MONOMIAL_SHIFT_PREC_2,
    SIGN_MONOMIAL_SHIFT_PREC_3,  SIGN_MONOMIAL_SHIFT_PREC_4,
    SIGN_MONOMIAL_SHIFT_PREC_5,  SIGN_MONOMIAL_SHIFT_PREC_6,
    SIGN_MONOMIAL_SHIFT_PREC_7,  SIGN_MONOMIAL_SHIFT_PREC_8,
    SIGN_MONOMIAL_SHIFT_PREC_9,  SIGN_MONOMIAL_SHIFT_PREC_10,
    SIGN_MONOMIAL_SHIFT_PREC_11, SIGN_MONOMIAL_SHIFT_PREC_12,
    SIGN_MONOMIAL_SHIFT_PREC_13, SIGN_MONOMIAL_SHIFT_PREC_14,
    SIGN_MONOMIAL_SHIFT_PREC_15, SIGN_MONOMIAL_SHIFT_PREC_16,
    SIGN_MONOMIAL_SHIFT_PREC_17, SIGN_MONOMIAL_SHIFT_PREC_18,
    SIGN_MONOMIAL_SHIFT_PREC_19, SIGN_MONOMIAL_SHIFT_PREC_20,
    SIGN_MONOMIAL_SHIFT_PREC_21, SIGN_MONOMIAL_SHIFT_PREC_22,
    SIGN_MONOMIAL_SHIFT_PREC_23, SIGN_MONOMIAL_SHIFT_PREC_24,
    SIGN_MONOMIAL_SHIFT_PREC_25, SIGN_MONOMIAL_SHIFT_PREC_26,
    SIGN_MONOMIAL_SHIFT_PREC_27, SIGN_MONOMIAL_SHIFT_PREC_28,
    SIGN_MONOMIAL_SHIFT_PREC_29, SIGN_MONOMIAL_SHIFT_PREC_30};

static const std::vector<Real> SIGN_MONOMIAL_F{
    2.07065026785700450201e+00, -8.37076006356984725951e-01,
    -2.52584798728603054810e+00, -3.12500000000000000000e-01};

static u64 getNumIter(u64 prec) {
    return prec ? SIGN_MONOMIAL_COEFF[prec - 1].size() : 0;
}

static const std::vector<Real> &getAcess(const u64 in_prec, const u64 index) {
    if (in_prec >= 31)
        throw std::out_of_range(
            "getIntro input precision must be less than 31...");
    if (index < getNumIter(in_prec))
        return SIGN_MONOMIAL_COEFF[in_prec - 1][index];
    return SIGN_MONOMIAL_F;
}

} // namespace SignCoeffDecomposeTable


void computeOptimalSevenDegree(const HomEvaluator &eval, const Ciphertext &ctxt,
                               Ciphertext &res, const u64 in_prec,
                               const u64 index, const Real scale) {
    computeDegreeSevenOddOfFactorization(
        eval, SignCoeffDecomposeTable::getAcess(in_prec, index), ctxt, res,
        scale);
}

u64 getNumSignDecompose(u64 prec) {
    return SignCoeffDecomposeTable::getNumIter(prec);
}

int iterShiftWithPrec(u64 in_prec, int out_prec) {
    u64 in_prec_index = in_prec ? in_prec - 1 : 0;
    for (int i = 0; i < 4; i++) {
        if (out_prec <=
            SignCoeffDecomposeTable::SIGN_MONOMIAL_SHIFT_PREC[in_prec_index][i])
            continue;
        return i - 2;
    }
    return 1;
}

